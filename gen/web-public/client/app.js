// Generated by CoffeeScript 1.9.0
(function() {
  var app, mod;

  app = angular.module('PublicApp', ['ngRoute', 'oc.modal', 'ui.bootstrap']);

  mod = require('web-app-modules/gen/client');

  app.controller('IndexController', require('./index-controller'));

  app.factory('LoginInterceptor', mod.auth.loginInterceptor);

  app.config([
    '$httpProvider', '$routeProvider', function($httpProvider, $routeProvider) {
      var userPromise;
      $httpProvider.interceptors.push('LoginInterceptor');
      userPromise = {
        xxx: function($q, $http, $rootScope) {
          var i;
          if ($rootScope.user) {
            return;
          }
          i = $q.defer();
          $http.get('module/auth/getLogin').success(function(data) {
            $rootScope.user = data.user;
            return i.resolve();
          }).error(function() {
            delete $rootScope.user;
            return i.reject();
          });
          return i.promise;
        }
      };
      return $routeProvider.when('/', {
        controller: require('./home/home'),
        templateUrl: 'home/home.html',
        resolve: userPromise
      }).when('/contact', {
        controller: require('./messaging/messaging'),
        templateUrl: '/messaging/messaging.html',
        resolve: userPromise
      }).when('/features', {
        controller: require('./messaging/messaging'),
        templateUrl: '/messaging/messaging.html',
        resolve: userPromise
      }).otherwise({
        redirectTo: '/'
      });
    }
  ]);

  module.exports = app;

}).call(this);
